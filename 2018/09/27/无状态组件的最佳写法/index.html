<!DOCTYPE html>
<html lang="zh-Hans">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="ä¸ä¼šæè‰ºæœ¯çš„ç¨‹åºå‘˜ä¸æ˜¯å¥½è®¾è®¡å¸ˆ">
    

    <!--Author-->
    
        <meta name="author" content="hk">
    

    <!-- Title -->
    
    <title>æ— çŠ¶æ€ç»„ä»¶çš„æœ€ä½³å†™æ³• | HK&#39;s blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Noto+Serif:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>

    <!-- Content -->
    <section class="article-container">
<!-- Back Home -->
<a class="nav-back" href="/">
    <i class="fa fa-puzzle-piece"></i>
</a>

<!-- Page Header -->
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>æ— çŠ¶æ€ç»„ä»¶çš„æœ€ä½³å†™æ³•</h1>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Main Content -->
            <div class="post-content col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <h2 id="é»˜è®¤æ¸²æŸ“è¡Œä¸ºçš„é—®é¢˜"><a href="#é»˜è®¤æ¸²æŸ“è¡Œä¸ºçš„é—®é¢˜" class="headerlink" title="é»˜è®¤æ¸²æŸ“è¡Œä¸ºçš„é—®é¢˜"></a>é»˜è®¤æ¸²æŸ“è¡Œä¸ºçš„é—®é¢˜</h2><p>åœ¨React Componentçš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œæœ‰ä¸€ä¸ªshouldComponentUpdateæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•é»˜è®¤è¿”å›å€¼æ˜¯trueã€‚</p>
<p>è¿™æ„å‘³ç€å°±ç®—æ²¡æœ‰æ”¹å˜ç»„ä»¶çš„propsæˆ–è€…stateï¼Œä¹Ÿä¼šå¯¼è‡´ç»„ä»¶çš„é‡ç»˜ã€‚è¿™å°±ç»å¸¸å¯¼è‡´ç»„ä»¶å› ä¸ºä¸ç›¸å…³æ•°æ®çš„æ”¹å˜å¯¼è‡´é‡ç»˜ï¼Œè¿™æå¤§çš„é™ä½äº†Reactçš„æ¸²æŸ“æ•ˆç‡</p>
<p>è°ƒç”¨äº†setStateæ–¹æ³•å, ä¼šè§¦å‘ç»„ä»¶çš„renderæ–¹æ³•, å¹¶ä¸”stateå¦‚æœæœ‰ä¼ ç»™å­ç»„ä»¶çš„è¯ä¹Ÿä¼šå¯¼è‡´å­ç»„ä»¶çš„æ›´æ–°, ä½†æ˜¯å¦‚æœ setStateå‰åç»„ä»¶çš„stateå¹¶æ²¡æœ‰æ”¹å˜çš„è¯, è¿˜æ˜¯ä¼šè§¦å‘ç»„ä»¶æå…¶å­ç»„ä»¶çš„æ›´æ–°, è¿™æ ·å°±é€ æˆäº†æ€§èƒ½çš„æµªè´¹, æ‰€ä»¥å¯ä»¥ä½¿ç”¨reactæä¾›çš„ PureComponentç»„ä»¶.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component, PureComponent &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Temp</span> <span class="keyword">extends</span> <span class="title">PureComponent</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'render Temp'</span>);</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;&#123; <span class="keyword">this</span>.props.val &#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">class App extends Component &#123;</span></span><br><span class="line"><span class="regexp">  state = &#123;</span></span><br><span class="line"><span class="regexp">    val: 1</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  componentDidMount() &#123;</span></span><br><span class="line"><span class="regexp">    setInterval(() =&gt; &#123;</span></span><br><span class="line"><span class="regexp">      this.setState(&#123;</span></span><br><span class="line"><span class="regexp">        val: 1</span></span><br><span class="line"><span class="regexp">      &#125;)</span></span><br><span class="line"><span class="regexp">    &#125;, 2000)</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    console.log('render App');</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;div className="App"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;header className="App-header"&gt;</span></span><br><span class="line"><span class="regexp">          &lt;img src=&#123;logo&#125; className="App-logo" alt="logo" /</span>&gt;</span><br><span class="line">          &lt;h1 className=<span class="string">"App-title"</span>&gt;Welcome to React&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>header&gt;</span><br><span class="line">        &lt;p className=<span class="string">"App-intro"</span>&gt;</span><br><span class="line">          To get started, edit &lt;code&gt;src/App.js&lt;<span class="regexp">/code&gt; and save to reload.</span></span><br><span class="line"><span class="regexp">        &lt;/</span>p&gt;</span><br><span class="line">        &lt;Temp val=&#123; <span class="keyword">this</span>.state.val &#125; /&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœTempç»„ä»¶ä¸ä½¿ç”¨PureComponentç»„ä»¶, è€Œæ˜¯ä½¿ç”¨æ™®é€šçš„æ— çŠ¶æ€ç»„ä»¶çš„è¯, å½“çˆ¶ç»„ä»¶çš„å®šæ—¶å™¨åœ¨è·‘çš„æ—¶å€™, Tempç»„ä»¶ä¹Ÿä¼šä¸æ–­çš„render, é€ æˆäº†æ€§èƒ½çš„æµªè´¹.<br>ä½¿ç”¨PureComponentåå¯ä»¥çœ‹åˆ°, Tempç»„ä»¶ä¸ä¼šrenderäº†</p>
<p>å¥½å¤„: æå‡æ€§èƒ½, å¯ä»¥å°‘å†™shouldComponentUpdate</p>
<h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>å½“ç»„ä»¶æ›´æ–°æ—¶ï¼Œå¦‚æœç»„ä»¶çš„ props å’Œ state éƒ½æ²¡å‘ç”Ÿæ”¹å˜ï¼Œ render æ–¹æ³•å°±ä¸ä¼šè§¦å‘ï¼Œçœå» Virtual DOM çš„ç”Ÿæˆå’Œæ¯”å¯¹è¿‡ç¨‹ï¼Œè¾¾åˆ°æå‡æ€§èƒ½çš„ç›®çš„ã€‚å…·ä½“å°±æ˜¯ React è‡ªåŠ¨å¸®æˆ‘ä»¬åšäº†ä¸€å±‚æµ…æ¯”è¾ƒï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>._compositeType === CompositeTypes.PureClass) &#123;</span><br><span class="line">    shouldUpdate = !shallowEqual(prevProps, nextProps) || !shallowEqual(inst.state, nextState);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è€Œ shallowEqual åˆåšäº†ä»€ä¹ˆå‘¢ï¼Ÿä¼šæ¯”è¾ƒ Object.keys(state | props) çš„é•¿åº¦æ˜¯å¦ä¸€è‡´ï¼Œæ¯ä¸€ä¸ª key æ˜¯å¦ä¸¤è€…éƒ½æœ‰ï¼Œå¹¶ä¸”æ˜¯å¦æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯åªæ¯”è¾ƒäº†ç¬¬ä¸€å±‚çš„å€¼ï¼Œç¡®å®å¾ˆæµ…ï¼Œæ‰€ä»¥æ·±å±‚çš„åµŒå¥—æ•°æ®æ˜¯å¯¹æ¯”ä¸å‡ºæ¥çš„ã€‚</p>
<h2 id="æ˜“å˜æ•°æ®ä¸èƒ½ä½¿ç”¨ä¸€ä¸ªå¼•ç”¨"><a href="#æ˜“å˜æ•°æ®ä¸èƒ½ä½¿ç”¨ä¸€ä¸ªå¼•ç”¨" class="headerlink" title="æ˜“å˜æ•°æ®ä¸èƒ½ä½¿ç”¨ä¸€ä¸ªå¼•ç”¨"></a>æ˜“å˜æ•°æ®ä¸èƒ½ä½¿ç”¨ä¸€ä¸ªå¼•ç”¨</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">PureComponent</span> </span>&#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    items: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">  &#125;</span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; items &#125; = <span class="keyword">this</span>.state;</span><br><span class="line">    items.pop();</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; items &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (&lt;div&gt;</span><br><span class="line">      &lt;ul&gt;</span><br><span class="line">        &#123;this.state.items.map(i =&gt; &lt;li key=&#123;i&#125;&gt;&#123;i&#125;&lt;/li&gt;)&#125;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line">      &lt;button onClick=&#123;this.handleClick&#125;&gt;delete&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¼šå‘ç°ï¼Œæ— è®ºæ€ä¹ˆç‚¹ delete æŒ‰é’®ï¼Œ li éƒ½ä¸ä¼šå˜å°‘ï¼Œå› ä¸º items ç”¨çš„æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œ shallowEqual çš„ç»“æœä¸º true ã€‚æ”¹æ­£</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; items &#125; = <span class="keyword">this</span>.state;</span><br><span class="line">  items.pop();</span><br><span class="line">  <span class="keyword">this</span>.setState(&#123; <span class="attr">items</span>: [].concat(items) &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·æ¯æ¬¡æ”¹å˜éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œä¹Ÿå°±å¯ä»¥ render äº†ã€‚</p>
<h2 id="ç»“æŸè¯­"><a href="#ç»“æŸè¯­" class="headerlink" title="ç»“æŸè¯­"></a>ç»“æŸè¯­</h2><p>PureComponent çœŸæ­£èµ·ä½œç”¨çš„ï¼Œåªæ˜¯åœ¨ä¸€äº›çº¯å±•ç¤ºç»„ä»¶ä¸Šï¼Œå¤æ‚ç»„ä»¶ç”¨äº†ä¹Ÿæ²¡å…³ç³»ï¼Œåæ­£ shallowEqual é‚£ä¸€å…³å°±è¿‡ä¸äº†ï¼Œä¸è¿‡è®°å¾— props å’Œ state ä¸èƒ½ä½¿ç”¨åŒä¸€ä¸ªå¼•ç”¨å“¦ã€‚</p>

 
                <!-- Meta -->
                <div class="post-meta">
                    <hr>
                    <br>
                    <div class="post-tags">
                        
                            

<a href="/tags/react/">#react</a>


                        
                    </div>
                    <div class="post-date">
                        2018 å¹´ 09 æœˆ 27 æ—¥
                    </div>
                </div>
            </div>

            <!-- Comments -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- Disqus Comments -->


            </div>
        </div>
    </div>
</article>
</section>

    <!-- Scripts -->
    <!-- jQuery -->
<script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="//cdn.bootcss.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<script type="text/javascript">
	console.log('Hexo-theme-hollow designed by zchen9 ğŸ™‹ Â© 2015-' + (new Date()).getFullYear());
</script>

    <!-- Google Analytics -->
    

</body>

</html>